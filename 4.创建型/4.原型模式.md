# 1.原型模式定义

如果对象的创建成本比较大，而同一个类的不同对象之间差别不大（大部分字段都相同），在这种情况下，可以利用对已有对象（原型）进行复制（或者叫拷贝）的方式，来创建新对象，以达到节省创建时间的目的。这种基于原型来创建对象的方式就叫作原型设计模式，简称原型模式。

用一个已经创建的实例作为原型，通过复制该原型对象来创建一个和原型相同或相似的新的对象。

## 2、原型模式的特点

原型模式的优点

- 可以**使用深克隆方式保存对象的状态**，使用原型模式将对复制一份，并将其状态保存起来，简化创建对象的过程。

原型模式的缺点

- **需要为每一类都配置一个 clone 方法**
- clone方法位于类内部，当对已有类进行改造的时候，需要修改代码，违背了开闭原则。
- **当实现深克隆时，需要编写较为复杂的代码。**

## 3、原型模式实现

原型模式有两种实现方法，深拷贝和浅拷贝。

- **浅拷贝**：创建一个新对象，新对象的属性和原来对象完全相同，对于非基本类型属性，仍指向原有属性所指向的对象的内存地址。
- **深拷贝**：创建一个新对象，属性中引用的其他对象也会被克隆，不再指向原有对象地址。

如果要拷贝的对象是不可变对象，浅拷贝共享不可变对象是没问题的，但对于可变对象来说，浅拷贝得到的对象和原始对象会共享部分数据，就有可能出现数据被修改的风险，也就变得复杂多了。

原型模式包含以下主要角色

- **抽象原型类**：规定了具体原型对象必须实现的接口。
- **具体原型类**：实现抽象原型类的 clone() 方法，它是可被复制的对象。
- **访问类**：使用具体原型类中的 clone() 方法来复制新的对象。

